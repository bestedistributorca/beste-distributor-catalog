<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beste Distributor - Product Catalog</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial,Helvetica,sans-serif;background:#f5f5f5;color:#333}
.header{background:linear-gradient(135deg,#2b8a8a,#1e6b6b);color:#fff;text-align:center;padding:25px}
.container{max-width:1200px;margin:20px auto;padding:0 20px}
.toolbar{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:20px}
.btn{padding:10px 18px;border:none;border-radius:6px;font-weight:600;cursor:pointer}
.btn-primary{background:#2b8a8a;color:#fff}
.btn-secondary{background:#fff;border:2px solid #2b8a8a;color:#2b8a8a}
.products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}

.product-card{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.1);position:relative}
.sale-badge{position:absolute;top:10px;left:10px;background:#dc3545;color:#fff;padding:5px 8px;font-size:12px;border-radius:4px;font-weight:bold}
.product-image{height:180px;background:#eee}
.product-image img{width:100%;height:100%;object-fit:cover}
.product-info{padding:15px}
.product-price{font-size:20px;font-weight:bold;color:#2b8a8a}
.old-price{text-decoration:line-through;color:#999;font-size:14px}
.cart-btn{margin-top:10px;background:#ffc107;color:#333;padding:8px;border-radius:6px;font-weight:bold;width:100%;border:none;cursor:pointer}
.whatsapp-btn{display:block;margin-top:8px;background:#25D366;color:#fff;padding:10px;border-radius:6px;text-align:center;font-weight:bold;text-decoration:none}

.cart-fab{
 position:fixed;bottom:20px;right:20px;
 background:#25D366;color:#fff;
 padding:14px 18px;border-radius:50%;
 font-size:18px;font-weight:bold;
 cursor:pointer;z-index:999;
 box-shadow:0 4px 12px rgba(0,0,0,.3)
}

.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);align-items:center;justify-content:center;z-index:1000}
.modal.active{display:flex}
.modal-content{background:#fff;padding:20px;border-radius:8px;width:95%;max-width:420px;max-height:90vh;overflow:auto}

.cart-item{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.cart-item input{width:50px}

</style>
</head>

<body>

<div class="header">
<h1>Beste Distributor</h1>
<p>Shop smarter, Save more, Delivered fast</p>
</div>

<div class="container">
<div class="products-grid" id="productsGrid"></div>
</div>

<div class="cart-fab" onclick="openCart()">ðŸ›’ <span id="cartCount">0</span></div>

<!-- CART MODAL -->
<div class="modal" id="cartModal">
<div class="modal-content">
<h3>Your Order</h3>
<div id="cartItems"></div>
<p><strong>Total: $<span id="cartTotal">0.00</span></strong></p>
<button class="btn btn-primary" onclick="checkout()">Send Order on WhatsApp</button>
<button class="btn" onclick="closeCart()">Close</button>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

const firebaseConfig = {
 apiKey: "AIzaSyBK9-eeQ0E7ovI88jcmk9aa10GWpI9V30U",
 authDomain: "beste-distributor.firebaseapp.com",
 databaseURL: "https://beste-distributor-default-rtdb.firebaseio.com",
 projectId: "beste-distributor",
 storageBucket: "beste-distributor.firebasestorage.app",
 messagingSenderId: "384320855826",
 appId: "1:384320855826:web:349cfb70dae242f0f19dcb"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let products={}, cart={};

onValue(ref(db,"products"),snap=>{
 products={};
 snap.forEach(c=>products[c.key]=c.val());
 render();
});

function render(){
 const g=productsGrid; g.innerHTML="";
 Object.entries(products).forEach(([id,p])=>{
  const sale=p.prevPrice && p.prevPrice>p.price;
  const percent=sale?Math.round((1-p.price/p.prevPrice)*100):0;
  g.innerHTML+=`
  <div class="product-card">
   ${sale?`<div class="sale-badge">${percent}% OFF</div>`:''}
   <div class="product-image">${p.image?`<img src="${p.image}">`:''}</div>
   <div class="product-info">
    <strong>${p.name}</strong>
    ${sale?`<div class="old-price">$${p.prevPrice}</div>`:''}
    <div class="product-price">$${p.price}</div>
    <button class="cart-btn" onclick="addToCart('${id}')">âž• Add to Cart</button>
   </div>
  </div>`;
 });
}

window.addToCart=id=>{
 cart[id]=(cart[id]||0)+1;
 updateCart();
};

function updateCart(){
 cartCount.textContent=Object.values(cart).reduce((a,b)=>a+b,0);
}

window.openCart=()=>{
 cartModal.classList.add("active");
 const list=cartItems; list.innerHTML="";
 let total=0;
 Object.entries(cart).forEach(([id,q])=>{
  const p=products[id];
  const sub=p.price*q; total+=sub;
  list.innerHTML+=`
  <div class="cart-item">
   <span>${p.name} ($${p.price})</span>
   <input type="number" min="1" value="${q}" onchange="cart['${id}']=this.value;updateCart();openCart()">
  </div>`;
 });
 cartTotal.textContent=total.toFixed(2);
};

window.closeCart=()=>cartModal.classList.remove("active");

window.checkout=()=>{
 let msg="Hello, I would like to order:%0A";
 let total=0;
 Object.entries(cart).forEach(([id,q])=>{
  const p=products[id];
  total+=p.price*q;
  msg+=`â€¢ ${p.name} x${q} â€” $${(p.price*q).toFixed(2)}%0A`;
 });
 msg+=`%0ATotal: $${total.toFixed(2)}`;
 window.open(`https://wa.me/14372600437?text=${msg}`,'_blank');
};
</script>

</body>
</html>
